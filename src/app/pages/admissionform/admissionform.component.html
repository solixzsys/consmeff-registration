<p-toast position="top-right"></p-toast>

<!-- Main Content -->
<div  [class.sidebar-visible]="sidebarVisible">
  
    
    <div class="page-title">Admission Form</div>
    
    <!-- Success Dialog -->
    <p-dialog 
      [(visible)]="visible" 
      [modal]="true"
      [dismissableMask]="true" 
      [closeOnEscape]="true" 
      [resizable]="false"
      [style]="{width: '90vw', maxWidth: '500px'}"
      styleClass="success-dialog">
      
      <ng-template pTemplate="header">
        <div class="dialog-header-content">
          <i class="pi pi-check-circle header-icon"></i>
          <span class="dialog-title">Registration Complete</span>
        </div>
      </ng-template>

      <div class="dialog-content">
        <i class="pi pi-check-circle success-icon"></i>
        <h2 class="congrats-title">Congratulations!</h2>
        <p class="congrats-message">
          You have successfully completed your registration process.
          We're excited to have you join our academic community!
        </p>

        <div class="next-steps">
          <div class="next-steps-title">What's Next?</div>
          <p>You will receive an email shortly with details about the next steps in your academic journey.</p>
        </div>

        <div class="dialog-actions">
          <p-button 
            label="Got It!" 
            (onClick)="done()" 
            styleClass="success-button"
            icon="pi pi-arrow-right"
            iconPos="right">
          </p-button>
        </div>
      </div>
    </p-dialog>

    <!-- Stepper Section -->
    <div class="stepper-wrapper">
      <p-stepper [(value)]="activeStepIndex" [linear]="false">
        
        <p-step-list>
          <p-step [value]="1">
            <span class="step-label">Personal Details</span>
          </p-step>
          <p-step [value]="2">
            <span class="step-label">Next of Kin</span>
          </p-step>
          <p-step [value]="3">
            <span class="step-label">Academic History</span>
          </p-step>
          <p-step [value]="4">
            <span class="step-label">Documents</span>
          </p-step>
          <p-step [value]="5">
            <span class="step-label">Summary</span>
          </p-step>
        </p-step-list>

        <p-step-panels>
          <!-- Step 1: Personal Details -->
          <p-step-panel [value]="1">
            <ng-template #content let-activateCallback="activateCallback">
              <div class="step-content">
                <app-personaldetails></app-personaldetails>
                
                <div class="step-actions">
                  <p-button 
                    label="Save and Continue" 
                    [disabled]="!formStepStatus.personalinfoValid"
                    [loading]="isLoadingPersonal"
                    (onClick)="saveAndMoveToStep(2, savePersonalDetails.bind(this))"
                    styleClass="primary-btn"
                    icon="pi pi-arrow-right"
                    iconPos="right">
                  </p-button>
                </div>
              </div>
            </ng-template>
          </p-step-panel>

          <!-- Step 2: Next of Kin -->
          <p-step-panel [value]="2">
            <ng-template #content let-activateCallback="activateCallback">
              <div class="step-content">
                <app-nextofkin></app-nextofkin>
                
                <div class="step-actions">
                  <p-button 
                    label="Back" 
                    (onClick)="activateCallback(1)"
                    styleClass="secondary-btn"
                    icon="pi pi-arrow-left"
                    [outlined]="true">
                  </p-button>
                  
                  <p-button 
                    label="Save and Continue" 
                    [disabled]="!formStepStatus.nextofkinValid"
                    [loading]="isLoadingNextOfKin"
                    (onClick)="saveAndMoveToStep(3, saveNextOfKinDetails.bind(this))"
                    styleClass="primary-btn"
                    icon="pi pi-arrow-right"
                    iconPos="right">
                  </p-button>
                </div>
              </div>
            </ng-template>
          </p-step-panel>

          <!-- Step 3: Academic History -->
          <p-step-panel [value]="3">
            <ng-template #content let-activateCallback="activateCallback">
              <div class="step-content">
                <app-academichistory></app-academichistory>
                
                <div class="step-actions">
                  <p-button 
                    label="Back" 
                    (onClick)="activateCallback(2)"
                    styleClass="secondary-btn"
                    icon="pi pi-arrow-left"
                    [outlined]="true">
                  </p-button>
                  
                  <p-button 
                    label="Save and Continue" 
                    [disabled]="!formStepStatus.academicValid"
                    [loading]="isLoadingAcademic"
                    (onClick)="saveAndMoveToStep(4, saveAcademicHistory.bind(this))"
                    styleClass="primary-btn"
                    icon="pi pi-arrow-right"
                    iconPos="right">
                  </p-button>
                </div>
              </div>
            </ng-template>
          </p-step-panel>

          <!-- Step 4: Document Upload -->
          <p-step-panel [value]="4">
            <ng-template #content let-activateCallback="activateCallback">
              <div class="step-content">
                <app-uploadform></app-uploadform>
                
                <div class="step-actions">
                  <p-button 
                    label="Back" 
                    (onClick)="activateCallback(3)"
                    styleClass="secondary-btn"
                    icon="pi pi-arrow-left"
                    [outlined]="true">
                  </p-button>
                  
                  <p-button 
                    label="Save and Continue" 
                    [disabled]="!formStepStatus.docuplodValid"
                    [loading]="isLoadingDocuments"
                    (onClick)="saveAndMoveToStep(5, saveDocumentUpload.bind(this))"
                    styleClass="primary-btn"
                    icon="pi pi-arrow-right"
                    iconPos="right">
                  </p-button>
                </div>
              </div>
            </ng-template>
          </p-step-panel>

          <!-- Step 5: Application Summary -->
          <p-step-panel [value]="5">
            <ng-template #content let-activateCallback="activateCallback">
              <div class="step-content">
                <app-applicationsummary></app-applicationsummary>
                
                <div class="step-actions">
                  <p-button 
                    label="Back" 
                    (onClick)="activateCallback(4)"
                    styleClass="secondary-btn"
                    icon="pi pi-arrow-left"
                    [outlined]="true">
                  </p-button>
                  
                  <p-button 
                    label="Submit and Confirm" 
                    (onClick)="confirm()"
                    styleClass="primary-btn"
                    icon="pi pi-check"
                    iconPos="right">
                  </p-button>
                </div>
              </div>
            </ng-template>
          </p-step-panel>
        </p-step-panels>
      </p-stepper>
    </div>
 
</div>